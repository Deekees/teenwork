<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard | TeenWork</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <div class="container nav-container">
      <a href="index.html" class="logo">TeenWork</a>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html">Home</a></li>
        <li><a href="jobs.html">Jobs</a></li>
        <li><a href="courses.html">Courses</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li id="dashboardNav" style="display:none;"><a href="dashboard.html">Dashboard</a></li>
        <li id="adminNav" style="display:none;"><a href="admin.html">Admin Dashboard</a></li>
      </ul>
      <button class="menu-toggle" id="menuToggle" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
      <div class="auth-buttons">
        <button id="loginBtn" class="btn btn-primary" style="margin-right:0.5rem;">Login</button>
        <button id="signupBtn" class="btn">Sign Up</button>
        <button id="logoutBtn" class="btn" style="display:none;">Logout</button>
      </div>
    </div>
  </nav>
  <main class="container" style="margin-top:2em;">
    <h1>Admin Dashboard</h1>
    <input id="adminUserSearch" type="text" placeholder="Search by username or email..." style="width:100%;max-width:350px;padding:0.7em 1em;margin-bottom:1.5em;border-radius:12px;border:1px solid #d0e6f7;box-shadow:var(--shadow);font-size:1.05em;">
    <div id="adminUsersList"></div>
  </main>
  <div id="deleteUserModal" class="modal">
    <div class="modal-content" style="max-width:340px; text-align:center;">
      <span class="close" id="closeDeleteUserModal">&times;</span>
      <h2>Delete Account</h2>
      <p>Are you sure you want to delete this account?</p>
      <button id="confirmDeleteUserBtn" style="background:#e74c3c; color:#fff; font-weight:600; border:2px solid #e74c3c; border-radius:var(--radius); padding:0.7rem 2rem; margin-top:1.2em; cursor:pointer;">Yes</button>
      <button id="cancelDeleteUserBtn" style="background:transparent; color:#222; font-weight:600; border:2px solid #222; border-radius:var(--radius); padding:0.7rem 2rem; margin-top:1.2em; margin-left:1em; cursor:pointer;">No</button>
    </div>
  </div>
  <script src="main.js"></script>
  <script>
    // Redirect if not admin
    const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
    if (!currentUser || currentUser.username !== 'admin') {
      window.location.href = 'index.html';
    }
    // Ensure adminNav is visible
    document.getElementById('adminNav').style.display = '';
    let deleteUserIdx = null;
    function renderAdminUsers() {
      let users = JSON.parse(localStorage.getItem('users') || '[]');
      const search = (document.getElementById('adminUserSearch')?.value || '').toLowerCase();
      let filtered = users.filter(u =>
        u.username.toLowerCase().includes(search) ||
        u.email.toLowerCase().includes(search)
      );
      let html = `<table style="width:100%; border-collapse:separate; border-spacing:0 18px; margin-top:2em;">
        <tr style="background:#f8fbff;"><th style="padding:0.7em;">Username</th><th>Email</th><th>Role</th><th>Created</th><th>Action</th></tr>`;
      filtered.forEach((u, idx) => {
        html += `<tr style="border-bottom:1px solid #e3f1fa; background:#fff; box-shadow:0 2px 8px #e3f1fa; border-radius:18px; overflow:hidden;">
          <td style="padding:1.2em 1.5em; border-radius:18px 0 0 18px;">${u.username}</td>
          <td style="padding:1.2em 1em;">${u.email}</td>
          <td style="padding:1.2em 1em;">
            <select id="roleSelect${idx}" style="padding:0.3em 1em; border-radius:8px;">
              <option value="user" ${u.role === 'user' || !u.role ? 'selected' : ''}>User</option>
              <option value="employer" ${u.role === 'employer' ? 'selected' : ''}>Employer</option>
              <option value="admin" ${u.role === 'admin' ? 'selected' : ''}>Admin</option>
            </select>
          </td>
          <td style="padding:1.2em 1em;">${u.createdAt ? new Date(u.createdAt).toLocaleString() : '<span style=\'color:#aaa\'>(unknown)</span>'}</td>
          <td style="padding:1.2em 1em; border-radius:0 18px 18px 0;">
            <button class="btn" onclick="saveUserRole(${users.indexOf(u)})">Save</button>
            <button class="btn" style="background:#e74c3c; color:#fff; margin-left:0.5em;" onclick="showDeleteUserModal(${users.indexOf(u)})">Delete</button>
          </td>
        </tr>`;
      });
      html += `</table>`;
      document.getElementById('adminUsersList').innerHTML = html;
    }
    renderAdminUsers();
    document.getElementById('adminUserSearch').addEventListener('input', renderAdminUsers);
    window.saveUserRole = function(idx) {
      let users = JSON.parse(localStorage.getItem('users') || '[]');
      const select = document.getElementById('roleSelect' + idx);
      users[idx].role = select.value;
      localStorage.setItem('users', JSON.stringify(users));
      renderAdminUsers();
    };
    window.showDeleteUserModal = function(idx) {
      deleteUserIdx = idx;
      document.getElementById('deleteUserModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    };
    document.getElementById('closeDeleteUserModal').onclick = function() {
      document.getElementById('deleteUserModal').classList.remove('active');
      document.body.style.overflow = '';
      deleteUserIdx = null;
    };
    document.getElementById('cancelDeleteUserBtn').onclick = function() {
      document.getElementById('deleteUserModal').classList.remove('active');
      document.body.style.overflow = '';
      deleteUserIdx = null;
    };
    document.getElementById('confirmDeleteUserBtn').onclick = function() {
      if (deleteUserIdx !== null) {
        let users = JSON.parse(localStorage.getItem('users') || '[]');
        users.splice(deleteUserIdx, 1);
        localStorage.setItem('users', JSON.stringify(users));
        renderAdminUsers();
      }
      document.getElementById('deleteUserModal').classList.remove('active');
      document.body.style.overflow = '';
      deleteUserIdx = null;
    };
  </script>
</body>
</html> 